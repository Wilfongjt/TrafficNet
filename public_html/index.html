<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang=""> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="apple-touch-icon" href="apple-touch-icon.png">

        <link rel="stylesheet" href="css/normalize.min.css">
        <link rel="stylesheet" href="css/main.css">

        <script src="js/vendor/modernizr-2.8.3-respond-1.4.2.min.js"></script>
        <style>
            .done {
                color: darkgray;
            }
        </style>
    </head>
    <body>
        <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

        <div class="header-container">
            <header class="wrapper clearfix">
                <h1 class="title">Traffic Net</h1>
                <nav>
                    <ul>
                        <li><a class="start" href="#">Start</a></li>
                        <li><a class="stop" href="#">Stop</a></li>
                    </ul>
                </nav>
            </header>
        </div>

        <div class="main-container">
            <div class="main wrapper clearfix">

                <article>
                    <header>
                        <h1>Description</h1>
                        <p>RoadNet is a traffic simulation. Cars drive around the network making random turns, creating traffic jams, and riding bumpers.</p>
                    </header>
                    <section>
                        <h2>The Road Network</h2>


                        <!-- *************************************** -->
                        <svg id="network" width="700" height="620">

                        </svg>
                    </section>
                    <section>
                        <h2>Application Road Map</h2>
                        <p></p>
                        <h3>Upcoming Features</h3>
                        <ul> 
                            <li>Animate the cars to refect model changes</li>
                            <li>Create real world road network</li>
                            <li>Port traffic model from Java </li>
                        </ul>
                        <h3>Completed Features</h3>
                        <ul> 

                            <li class="done">Automatically generate cars on road network using SVG</li>
                            <li class="done">Initialize road network using SVG</li>
         
                            <li class="done">Build a JSON file to describe a road network (multi-segment roads, one way roads, speed-limit by road, one or more turns, dead ends)</li>
                            <li class="done">Build a self-contained application to model traffic </li>
                        </ul>
                    </section>
                    <section>
                        <h2>Techniques and Technologies</h2>
                        <ul>
                            <li>Animation (d3.v4.min.js)</li>
                            
                            <li>Drawing (SVG)</li>
                            
                            <li>Geographic Data (JSON)</li>
                            
                            <li><a href="" target="_blank">Java Traffic Model (GITHub)</a></li>
                            
                            <li>Responsive (modernizr-2.8.3-respond-1.4.2.min.js)</li>

                        </ul>
                    </section>
                    <footer>
                        <h3></h3>
                        <p></p>
                    </footer>
                </article>

                <aside>
                    <h3>Map Key</h3>
                    <svg id="key">

                    </svg>
                </aside>

            </div> <!-- #main -->
        </div> <!-- #main-container -->

        <div class="footer-container">
            <footer class="wrapper">
                <h3>footer</h3>
            </footer>
        </div>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.11.2.min.js"><\/script>')</script>

        <script src="js/main.js"></script>

        <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
        <script>
            (function (b, o, i, l, e, r) {
                b.GoogleAnalyticsObject = l;
                b[l] || (b[l] =
                        function () {
                            (b[l].q = b[l].q || []).push(arguments)
                        });
                b[l].l = +new Date;
                e = o.createElement(i);
                r = o.getElementsByTagName(i)[0];
                e.src = '//www.google-analytics.com/analytics.js';
                r.parentNode.insertBefore(e, r)
            }(window, document, 'script', 'ga'));
            ga('create', 'UA-XXXXX-X', 'auto');
            ga('send', 'pageview');
        </script>
        <script src="https://d3js.org/d3.v4.min.js"></script>
        <script>
            //var network;
            //var url = 'http://localhost:3000/network/squareville';
            var url = 'data/squareville.json';
            //var svg;
            d3.json(url, function (error, graph) {
                //console.log(graph.network);

                var roads = d3.select("body")
                        .select("#network")
                        .append("g")
                        .attr("id", "roads")
                        .selectAll("line")
                        .data(graph.network) // set data array
                        .enter() // 
                        .selectAll("line")
                        .data(function (d) {
                            return d.feature; //<-- this is your array of points
                        })
                        .enter()
                        .append("line")
                        .attr("x1", function (d) {
                            //console.log("x0: " + JSON.stringify(d.coordinates[0].x));
                            return d.coordinates[0].x;
                        })
                        .attr("y1", function (d) {
                            //console.log("y0: " + JSON.stringify(d.coordinates[0].y));
                            return d.coordinates[0].y;
                        })
                        .attr("x2", function (d) {
                            //console.log("x1: " + JSON.stringify(d.coordinates[1].x));
                            return d.coordinates[1].x;
                        })
                        .attr("y2", function (d) {
                            //console.log("y1: " + JSON.stringify(d.coordinates[1].y));
                            return d.coordinates[1].y;
                        })
                        .attr("stroke-width", function (d) {
                            if (d.idx == 0) {
                                return 1.5;
                            }
                            return 0.5;
                        })
                        .attr("stroke", function (d) {
                            if (d.idx == 0) {
                                return "darkgrey";
                            }
                            return "lightgrey";
                        })
                        ;

                var cars = d3.select("body")
                        .select("#network")
                        .append("g") // add group for cars
                        .attr("id", "cars")
                        .selectAll("circle") // prepare to add circles
                        .data(graph.network) // set data array
                        .enter() // 
                        .append("circle")
                        .attr("cx", function (d) {
                            return d.feature[0].coordinates[0].x;
                        })
                        .attr("cy", function (d) {
                            return d.feature[0].coordinates[0].y;
                        })
                        .attr("r", 5)
                        .attr("fill", "blue");
                ;

                // Legend
                d3.select("#key")
                        .append("circle")
                        .attr("cx", 15)
                        .attr("cy", 20)
                        .attr("r", 5)
                        .attr("fill", "blue")
                d3.select("#key")
                        .append("text")
                        .style("fill", "black")
                        .attr("x", 44)
                        .attr("y", 24)
                        .text("Car");
                d3.select("#key")
                        .append("line")
                        .attr("x1", 10)
                        .attr("y1", 40)
                        .attr("x2", 40)
                        .attr("y2", 40)
                        .attr("stroke-width", 2)
                        .attr("stroke", "darkgray");
                d3.select("#key")
                        .append("text")
                        .style("fill", "black")
                        .attr("x", 45)
                        .attr("y", 44)
                        .text("Road begining");

                d3.select("#key")
                        .append("line")
                        .attr("x1", 10)
                        .attr("y1", 60)
                        .attr("x2", 40)
                        .attr("y2", 60)
                        .attr("stroke-width", 0.5)
                        .attr("stroke", "darkgray")
                        ;

                d3.select("#key")
                        .append("text")
                        .style("fill", "black")
                        .attr("x", 45)
                        .attr("y", 64)
                        .text("Road end");
                ;

            });

        </script>
    </body>
</html>
